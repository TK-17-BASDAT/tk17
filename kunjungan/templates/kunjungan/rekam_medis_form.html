{% comment %} tk17/kunjungan/templates/kunjungan/rekam_medis_form.html {% endcomment %}
{% comment %} 
    Tidak perlu <!DOCTYPE html>, <html>, <head>, <body> jika ini HANYA untuk modal.
    JavaScript akan mengambil .container dari response ini.
{% endcomment %}

<div class="container mx-auto px-4 py-2"> {# Class 'container' ini yang dicari oleh JS #}
    <h2 class="text-xl font-semibold text-gray-700 mb-4 pb-2 border-b border-gray-200">
        {% if is_update_form %}
            Rekam Medis
        {% else %}
            Rekam Medis Baru
        {% endif %}
    </h2>

    <div class="info-kunjungan mb-4 text-sm text-gray-600">
        <p><strong class="font-medium text-gray-700">Hewan:</strong> {{ kunjungan_data.nama_hewan_display }}</p>
        <p><strong class="font-medium text-gray-700">Klien:</strong> {{ kunjungan_data.nama_klien_display }}</p>
        <p><strong class="font-medium text-gray-700">ID Kunjungan:</strong> {{ kunjungan_data.id_kunjungan|slice:":8" }}...</p>
    </div>

    {% if error_message %} {# Jika Anda mengirim pesan error dari view #}
        <div class="p-3 mb-3 text-sm text-red-700 bg-red-100 rounded-lg border border-red-300" role="alert">
            {{ error_message }}
        </div>
    {% endif %}

    <form method="post" action="{% url 'kunjungan:rekam_medis_detail' id_kunjungan=id_kunjungan_url nama_hewan=nama_hewan_url no_identitas_klien=no_identitas_klien_url no_front_desk=no_front_desk_url no_perawat_hewan=no_perawat_hewan_url no_dokter_hewan=no_dokter_hewan_url %}" class="space-y-4">
        {% csrf_token %}
        <div>
            <label for="suhu" class="block text-sm font-medium text-gray-700 mb-1">Suhu Tubuh (Â°C):</label>
            <input type="number" step="0.1" id="suhu" name="suhu" value="{{ kunjungan_data.suhu|default_if_none:'' }}"
                   class="w-full border border-gray-300 rounded-md p-2 text-sm focus:ring-slate-500 focus:border-slate-500"
                   {% if not is_dokter %}disabled{% endif %}>
        </div>
        <div>
            <label for="berat_badan" class="block text-sm font-medium text-gray-700 mb-1">Berat Badan (kg):</label>
            <input type="number" step="0.01" id="berat_badan" name="berat_badan" value="{{ kunjungan_data.berat_badan|stringformat:".2f"|default_if_none:'' }}"
                   class="w-full border border-gray-300 rounded-md p-2 text-sm focus:ring-slate-500 focus:border-slate-500"
                   {% if not is_dokter %}disabled{% endif %}>
        </div>
        <div>
            <label for="catatan" class="block text-sm font-medium text-gray-700 mb-1">Catatan Medis:</label>
            <textarea id="catatan" name="catatan" rows="4"
                      class="w-full border border-gray-300 rounded-md p-2 text-sm focus:ring-slate-500 focus:border-slate-500"
                      {% if not is_dokter %}disabled{% endif %}>{{ kunjungan_data.catatan|default_if_none:'' }}</textarea>
        </div>
        <div class="flex justify-end pt-2">
            <button type="button" class="modal-close-button-secondary bg-gray-200 hover:bg-gray-300 text-gray-700 px-4 py-2 rounded-md text-sm mr-2">
                Tutup
            </button>
            {% if is_dokter %}
            <button type="submit"
                    class="bg-slate-800 hover:bg-slate-900 text-white px-6 py-2 rounded-md text-sm
                           {% if is_update_form %}bg-green-600 hover:bg-green-700{% endif %}">
                {% if is_update_form %}
                    Update Rekam Medis
                {% else %}
                    Simpan Rekam Medis
                {% endif %}
            </button>
            {% endif %}
        </div>
    </form>
</div>